import nmap
import scapy.all as scapy

def scan_network(network):
    """
    Scan a network for active hosts.
    :param network: Network range to scan (e.g., '192.168.1.0/24')
    :return: List of active hosts
    """
    nm = nmap.PortScanner()
    nm.scan(hosts=network, arguments='-sP')
    hosts_list = [(x, nm[x]['status']['state']) for x in nm.all_hosts()]
    return hosts_list

def scan_ports(ip):
    """
    Scan ports on a given host.
    :param ip: IP address of the host
    :return: Dictionary of open ports
    """
    nm = nmap.PortScanner()
    nm.scan(ip, '1-1024')
    return nm[ip]['tcp']
